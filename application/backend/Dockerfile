FROM oven/bun:latest

ENV STRIPE_WEBHOOK_SECRET, STRIPE_SECRET_KEY, TWILIO_MESSAGING_SERVICE, TWILIO_TOKEN, TWILIO_SID, STABILITY_API_KEY
ENV MONTHLY_PRICE_ID, ANNUAL_PRICE_ID, LIFETIME_PRICE_ID
ENV DB_USERNAME, DB_PASSWORD, DB_NAME
ENV EMAIL_CONTACT, EMAIL_VERIFICATION
ENV JWT_SECRET, SECRET_SAUCE

WORKDIR /app

COPY backend/ .

RUN bun install

RUN bun run build

RUN chmod +x ./server

EXPOSE 3000

CMD [ "./server" ]
